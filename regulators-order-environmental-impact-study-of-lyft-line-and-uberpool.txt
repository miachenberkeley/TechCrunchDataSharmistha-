Remember when a California regulatory agency tried to shut down carpooling services like UberPOOL and Lyft Line throughout the state? Well, you can breathe a sigh of relief.Two years after its initial threats, the California Public Utilities Commission (CPUC) has decided that the services are legal and can continue to operate. However, the CPUC has ordered Uber and Lyft to provide specifics about how their fares are calculated and to study their impacts on traffic and the environment.In the three short years since the CPUC took steps to recognize it, ridesharing has quickly become an important part of Californias transportation ecosystem. We are very happy that the Commission endorsed forward-thinking products like UberPOOL and listened to Californians advocating for programs to allow more drivers to earn money on their own time, an Uber spokesperson said in a statement.In September 2014, the CPUCtold Uber, Lyft and the now-defunct Sidecar that their carpool offerings violated a state law that forbids so-called charter party carriers like cabs and certain shuttles from charging flat, individual fares. The law requires that fares be based on miles traveled, time the ride took, or a combination of both.The district attorneys of San Francisco and Los Angeles piled on, asserting that UberPOOL and Lyft Line violated California law.In response, Uber and Lyft argued that those seemingly flat fares offered in UberPOOL and Lyft Line are in fact based on time and distance, and disclosed information about the algorithms used to determine the fares to CPUC. Uber and Lyft also argued that the carpooling features should be allowed because they created positive social and environmental impacts by preventing drunk driving and reducing pollution.In a decision issued Monday, the CPUC finally determined that carpool features would be allowed to continue operating in California.The facts of how the fare-splitting services operate and the absence of a public policy reason to cease such operations in California leads us to affirm the validity of these operations, the CPUC wrote in its decision.Although the decision is a win for Lyft and Uber (and for customers who dont like getting gouged by surge pricing), it will come at a cost. Starting next month, the CPUC willrequire the companies to report the specific calculations that go intocarpool fares (Uber and Lyft may claim that the algorithms they use to calculatecarpool fares are proprietary, in which case they can submit it to the CPUC under seal).The regulator is also forcing Uber and Lyft to back up their claims about the positive impact of carpool features by conducting studies of their own services.Each company will now be required to submit evidence of the impact that their fare-splitting operations have had on reducing traffic-related injuries to the CPUC, as well as evidence of the environmental impact that their fare-splitting operations have had.Uber and Lyft must submit plansto study their impacts on the environment and traffic by June 24. Uber has already made some information about the environmental impact of UberPOOL public as part of its Earth Day initiative.So far in 2016, if Uber riders had driven alone instead of sharing their rides we estimate that over 90 million more miles would have been traveled  consuming 1.8 million gallons of gas and emitting 16,000 metric tons of carbon dioxide, the company said in a blog post.Both companies are currently participating in a study conducted by theNatural Resources Defense Council and UCBerkeley that aims to provide the first comprehensive look at the environmental impact of services like UberPOOL and Lyft Line.The CPUCs decision allows Lyft to continue bringing innovative new features to market in California, such as Lyft Line which allows passengers to share rides for a reduced price, a Lyft spokesperson said in a statement. We look forward to continuing to work with the Commission to ensure that modern transportation options like ridesharing can grow across the state.